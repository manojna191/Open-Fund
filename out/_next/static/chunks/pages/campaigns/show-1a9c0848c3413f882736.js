(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[634],{84588:function(e,t,a){"use strict";a.r(t);var n=a(85893),s=a(809),r=a.n(s),c=a(92447),i=a(74047),o=a(4706),l=a(52700),u=a(8127),d=a(44102),h=a(20775),m=a(26265),p=a(67294),f=a(3542),b=a(68251),g=a(27904),x=a(73657);function j(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?j(Object(a),!0).forEach((function(t){(0,m.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):j(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,h.Z)(e);if(t){var s=(0,h.Z)(this).constructor;a=Reflect.construct(n,arguments,s)}else a=n.apply(this,arguments);return(0,d.Z)(this,a)}}var N=function(e){(0,u.Z)(a,e);var t=y(a);function a(e){var n;return(0,i.Z)(this,a),n=t.call(this,e),(0,m.Z)((0,o.Z)(n),"getAccount",(0,c.Z)(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.Z.eth.getAccounts();case 2:if(t=e.sent[0],n.state.account===t){e.next=14;break}return e.t0=n,e.t1=v,e.t2=v({},n.state),e.t3={},e.next=10,f.Z.eth.getAccounts();case 10:e.t4=e.sent[0],e.t5={account:e.t4},e.t6=(0,e.t1)(e.t2,e.t3,e.t5),e.t0.setState.call(e.t0,e.t6);case 14:case"end":return e.stop()}}),e)})))),(0,m.Z)((0,o.Z)(n),"contributionChangeHandler",(function(e){n.setState(v(v({},n.state),{},{contribution:e.target.value}))})),(0,m.Z)((0,o.Z)(n),"nameChangeHandler",(function(e){n.setState(v(v({},n.state),{},{name:e.target.value}))})),(0,m.Z)((0,o.Z)(n),"messageChangeHandler",(function(e){n.setState(v(v({},n.state),{},{message:e.target.value}))})),(0,m.Z)((0,o.Z)(n),"canDelete",(function(){return n.state.account==n.props.campaignDetails.owner})),(0,m.Z)((0,o.Z)(n),"formSubmitHandler",function(){var e=(0,c.Z)(r().mark((function e(t){var a,s,c;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,f.Z.eth.getAccounts();case 3:return a=e.sent[0],s=f.Z.utils.toWei(n.state.contribution,"ether"),c=(0,b.Z)(n.props.campaignDetails.address),e.next=8,c.methods.donations(n.state.name,n.state.message).send({from:a,value:s});case 8:n.setState(v(v({},n.state),{},{contribution:"",name:"",message:""})),g.Router.pushRoute("/campaigns/".concat(n.props.campaignDetails.address));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,m.Z)((0,o.Z)(n),"deleteCampaign",(0,c.Z)(r().mark((function e(){var t,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.Z.eth.getAccounts();case 2:return t=e.sent[0],a=(0,b.Z)(n.props.campaignDetails.address),e.next=6,a.methods.closeCamplaign().send({from:t});case 6:g.Router.pushRoute("/");case 7:case"end":return e.stop()}}),e)})))),n.state={contribution:"",name:"",message:"",account:""},n}return(0,l.Z)(a,null,[{key:"getInitialProps",value:function(){var e=(0,c.Z)(r().mark((function e(t){var a,n,s,c,i,o,l,u,d,h,m,p;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,b.Z)(t.query.address),e.next=3,a.methods.summary().call();case 3:return n=e.sent,e.next=6,a.methods.getDonarDetailsLength().call();case 6:return s=e.sent,e.next=9,a.methods.getRequestLength().call();case 9:c=e.sent,i=[],o=[],l=0;case 13:if(!(l<s)){e.next=21;break}return e.next=16,a.methods.donors_details(l).call();case 16:u=e.sent,i.push(u);case 18:l++,e.next=13;break;case 21:d=0;case 22:if(!(d<c)){e.next=30;break}return e.next=25,a.methods.request(d).call();case 25:(h=e.sent).status&&o.push(h);case 27:d++,e.next=22;break;case 30:return m=o.length+i.length,p={owner:n[0],campaign_Name:n[1],balance:n[2],totalTransactions:m,address:t.query.address,account:""},e.abrupt("return",{campaignDetails:p});case 33:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),(0,l.Z)(a,[{key:"render",value:function(){return this.getAccount(),(0,n.jsx)(x.Z,{children:(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{children:"".concat(this.props.campaignDetails.campaign_Name)}),(0,n.jsx)("hr",{}),(0,n.jsxs)("div",{className:"row",children:[(0,n.jsxs)("div",{className:"col-6",children:[(0,n.jsx)("h2",{className:"mb-4",children:"Campaign Details"}),(0,n.jsxs)("div",{className:"card text-bg-secondary mb-3",style:{maxWidth:"18rem"},children:[(0,n.jsx)("div",{className:"card-header",children:"Owner of the Campaign"}),(0,n.jsxs)("div",{className:"card-body",children:[(0,n.jsx)("h5",{className:"card-title",children:this.props.campaignDetails.owner}),(0,n.jsx)("p",{className:"card-text",children:"This is the address of the manager who is the beneficiary from the smart contract."})]})]}),(0,n.jsxs)("div",{className:"card text-bg-success mb-3",style:{maxWidth:"18rem"},children:[(0,n.jsx)("div",{className:"card-header",children:"Current Balance of the Campaign"}),(0,n.jsxs)("div",{className:"card-body",children:[(0,n.jsx)("h5",{className:"card-title",children:f.Z.utils.fromWei(this.props.campaignDetails.balance,"ether")}),(0,n.jsx)("p",{className:"card-text",children:"This is the total balance held in the Campaign as balance of smart contract"})]})]}),(0,n.jsxs)("div",{className:"card text-bg-primary mb-3",style:{maxWidth:"18rem"},children:[(0,n.jsx)("div",{className:"card-header",children:"Total transactions involved with the Campaign"}),(0,n.jsxs)("div",{className:"card-body",children:[(0,n.jsx)("h5",{className:"card-title",children:this.props.campaignDetails.totalTransactions}),(0,n.jsx)("p",{className:"card-text",children:"This is the sum of total (inflow + outflow) transactions involved with the Campaign"})]})]})]}),(0,n.jsxs)("div",{className:"col-6",children:[(0,n.jsx)("h2",{children:"Contribution"}),(0,n.jsxs)("form",{onSubmit:this.formSubmitHandler,children:[(0,n.jsxs)("div",{className:"mb-3",children:[(0,n.jsx)("label",{htmlFor:"contribution",className:"form-label",children:"Contribution (in Ether)"}),(0,n.jsx)("input",{value:this.state.contribution,onChange:this.contributionChangeHandler,type:"text",className:"form-control",id:"contribution",placeholder:"Enter the amount to be donated in ethers"})]}),(0,n.jsxs)("div",{className:"mb-3",children:[(0,n.jsx)("label",{htmlFor:"name",className:"form-label",children:"Name of doner"}),(0,n.jsx)("input",{value:this.state.name,onChange:this.nameChangeHandler,type:"text",className:"form-control",id:"name",placeholder:"Enter the name of the doner"})]}),(0,n.jsxs)("div",{className:"mb-3",children:[(0,n.jsx)("label",{htmlFor:"message",className:"form-label",children:"Donation Message"}),(0,n.jsx)("input",{value:this.state.message,onChange:this.messageChangeHandler,type:"text",className:"form-control",id:"message",placeholder:"Type your donation message here..."})]}),(0,n.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Submit"})]})]})]}),(0,n.jsx)(g.Link,{route:"/campaigns/".concat(this.props.campaignDetails.address,"/requests"),children:(0,n.jsx)("a",{children:(0,n.jsx)("button",{type:"button",className:"btn btn-primary",children:"View All Requests"})})}),(0,n.jsx)(g.Link,{route:"/campaigns/".concat(this.props.campaignDetails.address,"/transactions"),children:(0,n.jsx)("a",{children:(0,n.jsx)("button",{type:"button",className:"btn btn-success",children:"View All Transactions"})})}),this.canDelete()?(0,n.jsx)("button",{type:"button",className:"btn btn-danger",onClick:this.deleteCampaign,children:"Delete This Campaign"}):(0,n.jsx)("button",{type:"button",disabled:!0,className:"btn btn-danger",children:"Can't delete cmapaign (NOT OWNER)"})]})})}}]),a}(p.Component);t.default=N},86374:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/campaigns/show",function(){return a(84588)}])}},function(e){e.O(0,[482,773,486,774,888,179],(function(){return t=86374,e(e.s=t);var t}));var t=e.O();_N_E=t}]);